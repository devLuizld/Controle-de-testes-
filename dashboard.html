<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Controle de Testes - Botânica Bistrô</title>
<link rel="icon" href="https://static.thenounproject.com/png/green-flower-icon-3807932-512.png" type="image/png">
<style>
body { font-family: 'Poppins', sans-serif; background-color: #f5f5f5; margin:0; padding:20px; }
h1 { text-align:center; color:#2E7D32; }
#formulario input, #formulario select { padding:5px; margin:5px; }
#formulario button { padding:5px 10px; margin:5px; }
table { width:100%; border-collapse: collapse; margin-top:20px; background:#fff; box-shadow:0 0 10px rgba(0,0,0,0.1);}
th, td { border:1px solid #ddd; padding:10px; text-align:center;}
th { background:#4CAF50; color:white; }
tr:nth-child(even){ background:#f2f2f2; }
.btn { padding:5px 10px; margin:2px; border:none; border-radius:6px; cursor:pointer; color:white; }
.aprovado { background:#4CAF50; }
.reprovado { background:#f44336; }
.em-teste { background:#FF9800; }
.excluir { background:#9E9E9E; }

@media (max-width: 768px) {
    table, thead, tbody, th, td, tr { display:block; }
    th { display:none; }
    tr { margin-bottom:15px; border:1px solid #ddd; border-radius:10px; padding:10px; background:#fff; }
    td { border:none; padding:5px; text-align:right; position: relative; }
    td::before { content: attr(data-label); position: absolute; left:10px; width: 45%; font-weight:bold; text-align:left; }
    #formulario input, #formulario select, #formulario button { width:100%; box-sizing:border-box; }
    .btn { font-size:12px; padding:4px 8px; margin:2px; }
}
</style>
</head>
<body>

<h1>Controle de Testes - Botânica Bistrô</h1>

<div id="formulario">
    <input type="text" id="nome" placeholder="Nome do Candidato" required>
    <select id="cargo">
        <option value="">Selecione Cargo</option>
        <option>Auxiliar de Atendimento</option>
        <option>Auxiliar de Cozinha</option>
        <option>Auxiliar de Serviços Gerais</option>
        <option>Auxiliar de Confeitaria</option>
    </select>
    <select id="unidade">
        <option value="">Selecione Unidade</option>
        <option>Gávea</option>
        <option>Jardim Botânico</option>
        <option>Botafogo</option>
        <option>Tijuca</option>
    </select>
    <input type="number" id="dias" placeholder="Dias de Teste" min="1" required>
    <input type="date" id="data" required>
    <input type="text" id="horario" placeholder="Horário (Ex: 09h-12h)" required>
    <select id="status">
        <option value="Em Teste">Em Teste</option>
        <option value="Aprovado">Aprovado</option>
        <option value="Reprovado">Reprovado</option>
    </select>
    <button onclick="adicionarCandidato()">Adicionar Candidato</button>

    <select id="filtroUnidade" onchange="carregarCandidatos()">
        <option value="">Filtrar por Unidade</option>
        <option>Gávea</option>
        <option>Jardim Botânico</option>
        <option>Botafogo</option>
        <option>Tijuca</option>
    </select>
</div>

<table id="tabelaCandidatos">
    <thead>
        <tr>
            <th>Nome</th>
            <th>Cargo</th>
            <th>Unidade</th>
            <th>Data</th>
            <th>Horário</th>
            <th>Dias de Teste</th>
            <th>Status</th>
            <th>Ações</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxs76x5U_ZX5T8RRzxdtnDtK9zLWtg3S3zybEcy_7GQ7aHIxlnsoFozeDhp3Jo43dP_rg/exec"; // substitua pelo seu URL

// Adicionar candidato
async function adicionarCandidato() {
    const nome = document.getElementById('nome').value;
    const cargo = document.getElementById('cargo').value;
    const unidade = document.getElementById('unidade').value;
    const dias = document.getElementById('dias').value;
    const data = document.getElementById('data').value;
    const horario = document.getElementById('horario').value;
    const status = document.getElementById('status').value;

    if(!nome || !cargo || !unidade || !dias || !data || !horario || !status){
        alert("Preencha todos os campos!");
        return;
    }

    await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({acao:"add", Nome:nome, Cargo:cargo, Unidade:unidade, Dias:dias, Data:data, Horário:horario, Status:status})
    });

    limparFormulario();
    carregarCandidatos();
}

// Limpar formulário
function limparFormulario() {
    document.getElementById('nome').value = '';
    document.getElementById('cargo').value = '';
    document.getElementById('unidade').value = '';
    document.getElementById('dias').value = '';
    document.getElementById('data').value = '';
    document.getElementById('horario').value = '';
    document.getElementById('status').value = 'Em Teste';
}

// Atualizar candidato
async function atualizarCandidato(rowNumber, campo, valor){
    await fetch(API_URL, {
        method: "POST",
        body: JSON.stringify({acao:"update", rowNumber:rowNumber, campo:campo, valor:valor})
    });
    carregarCandidatos();
}

// Excluir candidato
async function excluirCandidato(rowNumber){
    if(confirm("Tem certeza que deseja excluir este candidato?")){
        await fetch(API_URL, {
            method: "POST",
            body: JSON.stringify({acao:"delete", rowNumber:rowNumber})
        });
        carregarCandidatos();
    }
}

// Carregar candidatos
async function carregarCandidatos() {
    const tbody = document.querySelector("#tabelaCandidatos tbody");
    const resp = await fetch(API_URL);
    const data = await resp.json();

    const filtro = document.getElementById('filtroUnidade').value;
    tbody.innerHTML = "";

    data.forEach((c) => {
        if(filtro && c.Unidade !== filtro) return;

        const tr = document.createElement("tr");
        tr.innerHTML = `
            <td data-label="Nome">${c.Nome}</td>
            <td data-label="Cargo">${c.Cargo}</td>
            <td data-label="Unidade">${c.Unidade}</td>
            <td data-label="Data">${c.Data}</td>
            <td data-label="Horário">${c.Horário}</td>
            <td data-label="Dias de Teste">${c.Dias}</td>
            <td data-label="Status" class="${c.Status==='Aprovado'?'aprovado':c.Status==='Reprovado'?'reprovado':'em-teste'}">${c.Status}</td>
            <td data-label="Ações">
                <button class="btn em-teste" onclick="atualizarCandidato(${c.rowNumber}, 'Dias', ${parseInt(c.Dias)+1})">+1 Dia</button>
                <button class="btn aprovado" onclick="atualizarCandidato(${c.rowNumber}, 'Status', 'Aprovado')">Aprovado</button>
                <button class="btn reprovado" onclick="atualizarCandidato(${c.rowNumber}, 'Status', 'Reprovado')">Reprovado</button>
                <button class="btn em-teste" onclick="atualizarCandidato(${c.rowNumber}, 'Status', 'Em Teste')">Em Teste</button>
                <button class="btn excluir" onclick="excluirCandidato(${c.rowNumber})">Excluir</button>
            </td>
        `;
        tbody.appendChild(tr);
    });
}

// Atualiza automaticamente a cada 3 segundos
setInterval(carregarCandidatos, 3000);
carregarCandidatos();
</script>

</body>
</html>
